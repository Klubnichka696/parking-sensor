/////     /////     /////     /////     импорт нескольких библиотек для дисплея     /////     /////     /////     /////
#include <Adafruit_GFX.h>
#include <Adafruit_SSD1306.h>
#include <Ultrasonic.h>          // импортируем библиотеку
Ultrasonic ultrasonic (11, 12);  // указываем пины для уз датчика
Ultrasonic ultrasoni (5, 6);     // указываем пины для 2-го уз датчика
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
#define del 5   // задержка между измерениями в мкс
#define cm1 50  // расстояние при котором включится зеленый светодиод
#define cm2 20  // расстояние при котором включится желтый светодиод
#define cm3 10  // расстояние при котором включится красный светодиод
#define cm4 5   // расстояние при котором включится зуммер
#define cm5 50  // расстояние при котором включится задний зеленый светодиод
#define cm6 20  // расстояние при котором включается задний желтый светодиод
#define cm7 10  // расстояние при котором включится задний красный светодиод
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
#define OLED_RESET 7
Adafruit_SSD1306 display(OLED_RESET);
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
void setup() 
{
   Serial.begin(9600);
   pinMode(8, OUTPUT);  // пин для красного заднего светодиода
   pinMode(9, OUTPUT);  // пин для желтого заднего светодиода
   pinMode(10, OUTPUT); // пин для зеленого заднего светодиода
   pinMode(7, OUTPUT);  // пин для подключения зуммера
   pinMode(2, OUTPUT);  // пин для зеленого светодиода
   pinMode(3, OUTPUT);  // пин для желтого светодиода
   pinMode(4, OUTPUT);  // пин для красного светодиода
}
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
void loop() 
{
   int distance, sum, total;
   sum = 0;
   for (byte i = 0; i <= 10; i++) 
   {
      distance = ultrasonic.read(CM);
      sum = sum + distance;
      delay(del);
   }
   total = sum / 10;
   Serial.println("Расстояние - " + String(total));
   int distance2, sum2, total2;
   sum2 = 0;
   for (byte i = 0; i <= 10; i++)
   {
      distance2 = ultrasoni.read(CM);
      sum2 = sum2 + distance2;
      delay(del);
   }
   total2 = sum2 / 10;
   Serial.println("Расстояние второго датчика - " + String(total2));
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
  display.begin(SSD1306_SWITCHCAPVCC, 0x3C);  // инициализация дисплея по интерфейсу I2C, адрес 0x3C
  display.clearDisplay(); // очистка дисплея
  display.setTextSize(1); // установка размера шрифта
  display.setTextColor(WHITE); // установка цвета текста
  display.setCursor(0, 1); // установка курсора в позицию X = 0; Y = 0
  display.print("Distance P - " + String(total)); // выводим значения
  display.setCursor(0, 10); // установка курсора в позицию X = 0; Y = 1
  display.print("Distance Z  - " + String(total2)); // выводим значения
  display.display(); // и её выводим на экран
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
   if (total >= cm1) 
   {
      digitalWrite(4, LOW); digitalWrite(3, LOW); digitalWrite(2, LOW); // ничего не горит
   }
   if (total2 >= cm5)
   {
      digitalWrite(8, LOW); digitalWrite(9, LOW); digitalWrite(10, LOW); // задние не горят
   }
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
   if (total < cm1 && total >= cm2) 
   {
      digitalWrite(4,LOW); digitalWrite(3,LOW); digitalWrite(2,HIGH); // загорается зеленый 
   }
   if (total2 < cm5 && total2 >= cm6)
   {
      digitalWrite(8,LOW); digitalWrite(9,LOW); digitalWrite(10,HIGH); // загорается задний зеленый
   }
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
   if (total < cm2 && total > cm3) 
   {
      digitalWrite(4,LOW); digitalWrite(3,HIGH); digitalWrite(2,LOW); // загорается желтый
   }
   if (total2 < cm6 && total2 >cm7)
   {
      digitalWrite(8,LOW); digitalWrite(9,HIGH); digitalWrite(10,LOW); // загорается задний желтый
   }
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
   if (total <= cm3) 
   {
      digitalWrite(4,HIGH); digitalWrite(3,LOW); digitalWrite(2,LOW); // загорается красный
   }
   if (total2 <= cm7)
   {
      digitalWrite(8,HIGH); digitalWrite(9,LOW); digitalWrite(10,LOW); // загорается задний красный
   }
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////     ВЫКЛ ПИЩАЛКА     /////     /////     /////     /////     /////     /////     /////     /////     /////
  if (total > cm4) 
  { 
    noTone(7); 
  }
  if (total2 > cm4)
  {
    noTone(7);
  }
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////     ВКЛ ПИЩАЛКА     /////     /////     /////     /////     /////     /////     /////     /////     /////
  if (total <= cm4) 
  { 
    tone(7,4900); // пищалка
  }
  if (total2 <= cm4)
  {
    tone(7,4900);
  }
}
